

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Common tasks &#8212; repo2docker 0.10.0 documentation</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="../_static/sphinx-bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link href="../_static/css/custom.css" rel="stylesheet">
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Adding a new buildpack to repo2docker" href="buildpack.html" />
    <link rel="prev" title="Design of repo2docker" href="../design.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">

<a class="navbar-brand" href="../index.html">
  <img src="../_static/logo.png" class="logo" alt="logo">
</a>

<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
</button>

<div id="navbar-menu" class="collapse navbar-collapse">
  <ul id="navbar-main-elements" class="navbar-nav mr-auto">
    <li class="nav-item">
        <a class="nav-link" href="../index.html">Home</a>
    </li>
    
    
    <li class="nav-item ">
        <a class="nav-link" href="../getting-started/index.html">Getting Started</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../howto/index.html">How-to Guides</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../configuration/index.html">Configuring your repository</a>
    </li>
    
    <li class="nav-item active">
        <a class="nav-link" href="index.html">Contributing</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../changelog.html">Changelog</a>
    </li>
    
  </ul>
  <ul class="navbar-nav ml-auto">
    <li class="nav-item">
      <a class="nav-link" href="https://github.com/pandas-dev/pandas" target="_blank" rel="noopener">
        <span><i class="fab fa-github-alt" style="color:#333;font-size:1rem;line-height:1.25"></i></span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="https://twitter.com/pandas_dev" target="_blank" rel="noopener">
        <span><i class="fab fa-twitter" style="color:#55acee;font-size:1rem;line-height:1.25"></i></span>
      </a>
    </li>
  </ul>
</div>
    </nav>

    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
              

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
      
      
      
      
        
          
              <li class="">
                  <a href="contributing.html">Contributing to repo2docker development</a>
              </li>
          
        
          
              <li class="">
                  <a href="roadmap.html">The repo2docker roadmap</a>
              </li>
          
        
          
              <li class="">
                  <a href="../architecture.html">Architecture of repo2docker</a>
              </li>
          
        
          
              <li class="">
                  <a href="../design.html">Design of repo2docker</a>
              </li>
          
        
          
              <li class="active">
                  <a href="">Common tasks</a>
              </li>
          
        
          
              <li class="">
                  <a href="buildpack.html">Adding a new buildpack to repo2docker</a>
              </li>
          
        
      
      
      
      
    </ul>

</nav>


              
          </div>

          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#running-tests" class="nav-link">Running tests</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#update-and-freeze-buildpack-dependencies" class="nav-link">Update and Freeze BuildPack Dependencies</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#conda-dependencies" class="nav-link">Conda dependencies</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#make-a-pull-request" class="nav-link">Make a Pull Request</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#creating-a-release" class="nav-link">Creating a Release</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#confirm-that-the-changelog-is-ready" class="nav-link">Confirm that the changelog is ready</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#create-a-new-tag-and-push-it" class="nav-link">Create a new tag and push it</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#create-a-new-release-on-the-github-repository" class="nav-link">Create a new release on the GitHub repository</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#update-the-change-log" class="nav-link">Update the change log</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#keeping-the-pipfile-and-requirements-files-up-to-date" class="nav-link">Keeping the Pipfile and requirements files up to date</a>
        </li>
    
    </ul>
</nav>
              
            </div>

          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
              <div>
                
  <div class="section" id="common-tasks">
<h1>Common tasks<a class="headerlink" href="#common-tasks" title="Permalink to this headline">¶</a></h1>
<p>These are some common tasks to be done as a part of developing
and maintaining repo2docker. If you’d like more guidance for how
to do these things, reach out in the <a class="reference external" href="https://gitter.im/jupyterhub/jupyterhub">JupyterHub Gitter channel</a>.</p>
<div class="section" id="running-tests">
<h2>Running tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h2>
<p>We have a lot of tests for various cases supported by repo2docker in the <code class="docutils literal notranslate"><span class="pre">tests/</span></code>
subdirectory. If you fix a bug or add new functionality consider adding a new
test to prevent the bug from coming back. These use
<a class="reference external" href="https://docs.pytest.org/">py.test</a>.</p>
<p>You can run all the tests with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>py.test -s tests/*
</pre></div>
</div>
<p>If you want to run a specific test, you can do so with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>py.test -s tests/&lt;path-to-test&gt;
</pre></div>
</div>
</div>
<div class="section" id="update-and-freeze-buildpack-dependencies">
<h2>Update and Freeze BuildPack Dependencies<a class="headerlink" href="#update-and-freeze-buildpack-dependencies" title="Permalink to this headline">¶</a></h2>
<p>This section covers the process by which repo2docker defines and updates the
dependencies that are installed by default for several buildpacks.</p>
<p>For both the <code class="docutils literal notranslate"><span class="pre">conda</span></code> and <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code> (<code class="docutils literal notranslate"><span class="pre">pip</span></code>) base environments in the <strong>Conda BuildPack</strong> and <strong>Python BuildPack</strong>,
we install specific pinned versions of all dependencies. We explicitly list the dependencies
we want, then <em>freeze</em> them at commit time to explicitly list all the
transitive dependencies at current versions. This way, we know that
all dependencies will have the exact same version installed at all times.</p>
<p>To update one of the dependencies shared across all <code class="docutils literal notranslate"><span class="pre">repo2docker</span></code> builds, you
must follow these steps (with more detailed information in the sections below):</p>
<ol class="simple">
<li><p>Make sure you have <a class="reference external" href="https://www.docker.com/">Docker</a> running on your computer</p></li>
<li><p>Bump the version numbers of the dependencies you want to update in the <code class="docutils literal notranslate"><span class="pre">conda</span></code> environment (<a class="reference external" href="https://github.com/jupyter/repo2docker/blob/master/CONTRIBUTING.md#conda-dependencies">link</a>)</p></li>
<li><p>Make a pull request with your changes (<a class="reference external" href="https://github.com/jupyter/repo2docker/blob/master/CONTRIBUTING.md#make-a-pull-request">link</a>)</p></li>
</ol>
<p>See the subsections below for more detailed instructions.</p>
<div class="section" id="conda-dependencies">
<h3>Conda dependencies<a class="headerlink" href="#conda-dependencies" title="Permalink to this headline">¶</a></h3>
<ol>
<li><p>There are two files related to conda dependencies. Edit as needed.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">repo2docker/buildpacks/conda/environment.yml</span></code></p>
<p>Contains list of packages to install in Python3 conda environments,
which are the default. <strong>This is where all Notebook versions &amp;
notebook extensions (such as JupyterLab / nteract) go</strong>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">repo2docker/buildpacks/conda/environment.py-2.7.yml</span></code></p>
<p>Contains list of packages to install in Python2 conda environments, which
can be specifically requested by users. <strong>This only needs <code class="docutils literal notranslate"><span class="pre">IPyKernel</span></code>
and kernel related libraries</strong>. Notebook / Notebook Extension need
not be installed here.</p>
</li>
</ul>
</li>
<li><p>Once you edit either of these files to add a new package / bump version on
an existing package, you should then run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ./repo2docker/buildpacks/conda/
python freeze.py
</pre></div>
</div>
<p>This script will resolve dependencies and write them to the respective <code class="docutils literal notranslate"><span class="pre">.frozen.yml</span></code>
files. You will need <code class="docutils literal notranslate"><span class="pre">docker</span></code> installed to run this script.</p>
</li>
<li><p>After the freeze script finishes, a number of files will have been created.
Commit the following subset of files to git:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">repo2docker</span><span class="o">/</span><span class="n">buildpacks</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">environment</span><span class="o">.</span><span class="n">yml</span>
<span class="n">repo2docker</span><span class="o">/</span><span class="n">buildpacks</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">environment</span><span class="o">.</span><span class="n">frozen</span><span class="o">.</span><span class="n">yml</span>
<span class="n">repo2docker</span><span class="o">/</span><span class="n">buildpacks</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">environment</span><span class="o">.</span><span class="n">py</span><span class="o">-</span><span class="mf">2.7</span><span class="o">.</span><span class="n">yml</span>
<span class="n">repo2docker</span><span class="o">/</span><span class="n">buildpacks</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">environment</span><span class="o">.</span><span class="n">py</span><span class="o">-</span><span class="mf">2.7</span><span class="o">.</span><span class="n">frozen</span><span class="o">.</span><span class="n">yml</span>
<span class="n">repo2docker</span><span class="o">/</span><span class="n">buildpacks</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">environment</span><span class="o">.</span><span class="n">py</span><span class="o">-</span><span class="mf">3.5</span><span class="o">.</span><span class="n">frozen</span><span class="o">.</span><span class="n">yml</span>
<span class="n">repo2docker</span><span class="o">/</span><span class="n">buildpacks</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">environment</span><span class="o">.</span><span class="n">py</span><span class="o">-</span><span class="mf">3.6</span><span class="o">.</span><span class="n">frozen</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
</li>
<li><p>Make a pull request; see details below.</p></li>
<li><p>Once the pull request is approved (but not yet merged), Update the
change log (details below) and commit the change log, then update
the pull request.</p></li>
</ol>
</div>
<div class="section" id="make-a-pull-request">
<h3>Make a Pull Request<a class="headerlink" href="#make-a-pull-request" title="Permalink to this headline">¶</a></h3>
<p>Once you’ve made the commit, please make a Pull Request to the <code class="docutils literal notranslate"><span class="pre">jupyterhub/repo2docker</span></code>
repository, with a description of what versions were bumped / what new packages were
added and why. If you fix a bug or add new functionality consider adding a new
test to prevent the bug from coming back/the feature breaking in the future.</p>
</div>
</div>
<div class="section" id="creating-a-release">
<h2>Creating a Release<a class="headerlink" href="#creating-a-release" title="Permalink to this headline">¶</a></h2>
<p>We try to make a release of repo2docker every few months if possible.</p>
<p>We follow <a class="reference external" href="https://semver.org/">semantic versioning</a>.</p>
<p>A new release will automatically be created when a new git tag is created
and pushed to the repository (using
<a class="reference external" href="https://github.com/jupyter/repo2docker/blob/master/.travis.yml#L52">Travis CI</a>).</p>
<p>To create a new release, follow these steps:</p>
<div class="section" id="confirm-that-the-changelog-is-ready">
<h3>Confirm that the changelog is ready<a class="headerlink" href="#confirm-that-the-changelog-is-ready" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/jupyter/repo2docker/blob/master/docs/source/changelog.rst">The changelog</a>
should reflect all significant enhancements and fixes to repo2docker and
its documentation. In addition, ensure that the correct version is displayed
at the top, and create a new <code class="docutils literal notranslate"><span class="pre">dev</span></code> section if needed.</p>
</div>
<div class="section" id="create-a-new-tag-and-push-it">
<h3>Create a new tag and push it<a class="headerlink" href="#create-a-new-tag-and-push-it" title="Permalink to this headline">¶</a></h3>
<p>First, tag a new release locally:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">V</span><span class="o">=</span><span class="m">0</span>.7.0<span class="p">;</span> git tag -am <span class="s2">&quot;release </span><span class="nv">$V</span><span class="s2">&quot;</span> <span class="nv">$V</span>
</pre></div>
</div>
<p>Then push this change up to the master repository</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="o">--</span><span class="n">tags</span>
</pre></div>
</div>
<p>Travis should automatically run the tests and, if they pass, create a
new release on the <a class="reference external" href="https://pypi.org/project/jupyter-repo2docker/">repo2docker PyPI</a>.
Once this has completed, make sure that the new version has been updated.</p>
</div>
<div class="section" id="create-a-new-release-on-the-github-repository">
<h3>Create a new release on the GitHub repository<a class="headerlink" href="#create-a-new-release-on-the-github-repository" title="Permalink to this headline">¶</a></h3>
<p>Once the new release has been pushed to PyPI, we need to create a new
release on the <a class="reference external" href="https://github.com/jupyter/repo2docker/releases">GitHub repository releases page</a>. Once on that page, follow these steps:</p>
<ul class="simple">
<li><p>Click “Draft a new release”</p></li>
<li><p>Choose a tag version using the same tag you just created above</p></li>
<li><p>The release name is simply the tag version</p></li>
<li><p>The description is <a class="reference external" href="https://github.com/jupyter/repo2docker/blob/master/docs/source/changelog.rst">a link to the Changelog</a>,
ideally with an anchor to the latest release.</p></li>
<li><p>Finally, click “Publish release”</p></li>
</ul>
<p>That’s it!</p>
</div>
</div>
<div class="section" id="update-the-change-log">
<h2>Update the change log<a class="headerlink" href="#update-the-change-log" title="Permalink to this headline">¶</a></h2>
<p>To add your change to the change log, find the relevant Feature/Bug
fix/API change section for the next release near the top of the file;
then add one or two sentences as a new bullet point about your
changes. Include the pull request or issue number between square
brackets at the end.</p>
<p>Some details:</p>
<ul>
<li><p>versioning follows the x.y.z, major.minor.bugfix numbering</p></li>
<li><p>bug fixes go into the next bugfix release. If there isn’t any, you
can create a new section (see point below). Don’t worry if you’re
not sure about that, and think it should go into a next major or
minor release: an admin will let you know, or move the change later
to the appropriate section</p></li>
<li><p>API changes should preferably go into the next major release, unless
they are backward compatible (for example, a deprecated function
keyword): then they can go into the next minor release. For release
with major release 0, non-backward compatible breaking changes are
also fine for the next minor release.</p></li>
<li><p>new features should go into the next minor release.</p></li>
<li><p>if there is no section for the appropriate release, you can add one:</p>
<p>follow the versioning scheme, by simply increasing the relevant
number for one of the major /minor/bugfix numbers, appropriate for
your change (see the above bullet points); add the release
section. Then add three subsections: new features, api changes, and
bug fixes. Leave out the sections that are not appropriate for the
newlye added release section.</p>
</li>
</ul>
<p>Release candidate versions in the change log are only temporary, and
should be superseded by either a next release candidate, or the final
release for that version (bugfix version 0).</p>
</div>
<div class="section" id="keeping-the-pipfile-and-requirements-files-up-to-date">
<h2>Keeping the Pipfile and requirements files up to date<a class="headerlink" href="#keeping-the-pipfile-and-requirements-files-up-to-date" title="Permalink to this headline">¶</a></h2>
<p>We now have both a <code class="docutils literal notranslate"><span class="pre">dev-requirements.txt</span></code> and a <code class="docutils literal notranslate"><span class="pre">Pifile</span></code> for repo2docker, as
such it is important to keep these in sync/up-to-date.</p>
<p>Both files use <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">identifiers</span></code> so if you are updating for example the Sphinx version
in the <code class="docutils literal notranslate"><span class="pre">doc-requirements.txt</span></code> (currently <code class="docutils literal notranslate"><span class="pre">Sphinx</span> <span class="pre">=</span> <span class="pre">&quot;&gt;=1.4,!=1.5.4&quot;</span></code>) you can use the
same syntax to update the Pipfile and viceversa.</p>
<p>At the moment this has to be done manually so please make sure to update both
files accordingly.</p>
</div>
</div>
<div class="section" id="uncommon-tasks">
<h1>Uncommon tasks<a class="headerlink" href="#uncommon-tasks" title="Permalink to this headline">¶</a></h1>
<div class="section" id="compare-generated-dockerfiles-between-repo2docker-versions">
<h2>Compare generated Dockerfiles between repo2docker versions<a class="headerlink" href="#compare-generated-dockerfiles-between-repo2docker-versions" title="Permalink to this headline">¶</a></h2>
<p>For larger refactorings it can be useful to check that the generated Dockerfiles match
between an older version of r2d and the current version. The following shell script
automates this test.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /bin/bash -e</span>

<span class="nv">current_version</span><span class="o">=</span><span class="k">$(</span>jupyter-repo2docker --version <span class="p">|</span> sed s@+@-@<span class="k">)</span>
<span class="nb">echo</span> <span class="s2">&quot;Comparing </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2"> (local </span><span class="nv">$current_version</span><span class="s2"> vs. </span><span class="nv">$R2D_COMPARE_TO</span><span class="s2">)&quot;</span>
<span class="nv">basename</span><span class="o">=</span><span class="s2">&quot;dockerfilediff&quot;</span>

diff_r2d_dockerfiles_with_version <span class="o">()</span> <span class="o">{</span>
    docker run --rm -t -v <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span>:<span class="s2">&quot;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span> --user <span class="m">1000</span> jupyter/repo2docker:<span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> jupyter-repo2docker --no-build --debug <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span> <span class="p">&amp;</span>&gt; <span class="s2">&quot;</span><span class="nv">$basename</span><span class="s2">&quot;</span>.<span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
    jupyter-repo2docker --no-build --debug <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span> <span class="p">&amp;</span>&gt; <span class="s2">&quot;</span><span class="nv">$basename</span><span class="s2">&quot;</span>.<span class="s2">&quot;</span><span class="nv">$current_version</span><span class="s2">&quot;</span>
    
    <span class="c1"># remove first line logging the path</span>
    sed -i <span class="s1">&#39;/^\[Repo2Docker\]/d&#39;</span> <span class="s2">&quot;</span><span class="nv">$basename</span><span class="s2">&quot;</span>.<span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
    sed -i <span class="s1">&#39;/^\[Repo2Docker\]/d&#39;</span> <span class="s2">&quot;</span><span class="nv">$basename</span><span class="s2">&quot;</span>.<span class="s2">&quot;</span><span class="nv">$current_version</span><span class="s2">&quot;</span>

    diff --strip-trailing-cr <span class="s2">&quot;</span><span class="nv">$basename</span><span class="s2">&quot;</span>.<span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$basename</span><span class="s2">&quot;</span>.<span class="s2">&quot;</span><span class="nv">$current_version</span><span class="s2">&quot;</span> <span class="p">|</span> colordiff
    rm <span class="s2">&quot;</span><span class="nv">$basename</span><span class="s2">&quot;</span>.<span class="s2">&quot;</span><span class="nv">$current_version</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$basename</span><span class="s2">&quot;</span>.<span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="nv">startdir</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nb">cd</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>

<span class="c1">#diff_r2d_dockerfiles 0.10.0-22.g4f428c3.dirty</span>
diff_r2d_dockerfiles_with_version <span class="s2">&quot;</span><span class="nv">$R2D_COMPARE_TO</span><span class="s2">&quot;</span>

<span class="nb">cd</span> <span class="s2">&quot;</span><span class="nv">$startdir</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Put the code above in a file <code class="docutils literal notranslate"><span class="pre">tests/dockerfile_diff.sh</span></code> and make it executable: <code class="docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">+x</span> <span class="pre">dockerfile_diff.sh</span></code>.</p>
<p>Configure the repo2docker version you want to compare with your local version in the environment variable <code class="docutils literal notranslate"><span class="pre">R2D_COMPARE_TO</span></code>.
The scripts takes one input: the directory where repo2docker should be executed.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> tests/
<span class="nv">R2D_COMPARE_TO</span><span class="o">=</span><span class="m">0</span>.10.0 ./dockerfile_diff.sh venv/py35/
</pre></div>
</div>
<p>Run it for all directories where there is a <code class="docutils literal notranslate"><span class="pre">verify</span></code> file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> tests/
<span class="nv">R2D_COMPARE_TO</span><span class="o">=</span><span class="m">0</span>.10.0 <span class="nv">CMD</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/dockerfile_diff.sh find . -name <span class="s1">&#39;verify&#39;</span> -execdir bash -c <span class="s1">&#39;$CMD $(pwd)&#39;</span> <span class="se">\;</span>
</pre></div>
</div>
<p>To keep the created Dockefilers for further inspection, comment out the deletion line in the script.</p>
</div>
</div>


              </div>
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="../design.html" title="previous page">Design of repo2docker</a>
    <a class='right-next' id="next-link" href="buildpack.html" title="next page">Adding a new buildpack to repo2docker</a>

              </div>
          </main>

      </div>
    </div><script>
    // TOC sidebar - add "active" class to parent list
    //
    // Bootstrap's scrollspy adds the active class to the <a> link,
    // but for the automatic collapsing we need this on the parent list item.
    //
    // The event is triggered on "window" (and not the nav item as documented),
    // see https://github.com/twbs/bootstrap/issues/20086
    $(window).on("activate.bs.scrollspy", function(){
    var navLinks = document.querySelectorAll('#bd-toc-nav a');
    for (var i = 0; i < navLinks.length; i++) {
        var navLink = navLinks[i];
        navLink.parentElement.classList.remove('active');
    }
    var navLinks = document.querySelectorAll('#bd-toc-nav a.active');
    for (var i = 0; i < navLinks.length; i++) {
        var navLink = navLinks[i];
        navLink.parentElement.classList.add('active');
    }
    });

    /**
     * Use left and right arrow keys to navigate forward and backwards.
    */
    const LEFT_ARROW_KEYCODE = 37
    const RIGHT_ARROW_KEYCODE = 39

    const getPrevUrl = () => document.getElementById('prev-link').href
    const getNextUrl = () => document.getElementById('next-link').href
    const initPageNav = (event) => {
        const keycode = event.which

        if (keycode === LEFT_ARROW_KEYCODE) {
            window.location.href = getPrevUrl();
        } else if (keycode === RIGHT_ARROW_KEYCODE) {
            window.location.href = getNextUrl();
        }
    };

    var keyboardListener = false;
    $( document ).ready(() => {
        if (keyboardListener === false) {
            document.addEventListener('keydown', initPageNav)
            keyboardListener = true;
        }
    });
</script>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Project Jupyter.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>